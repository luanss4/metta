<div class="card">
  <div class="card-header">
    <h2>{{ isEditMode ? 'Edit' : 'Create' }} Product</h2>
  </div>
  <div class="card-body">
    <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
      <div class="p-fluid formgrid grid">
        <div class="field col-12 md:col-6">
          <label for="descricao">Descrição *</label>
          <input id="descricao" type="text" pInputText formControlName="descricao" 
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['descricao'].errors}">
          <small *ngIf="submitted && f['descricao'].errors?.['required']" class="p-error">Descrição é obrigatória</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="marca">Marca *</label>
          <input id="marca" type="text" pInputText formControlName="marca" 
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['marca'].errors}">
          <small *ngIf="submitted && f['marca'].errors?.['required']" class="p-error">Marca é obrigatória</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="categoria">Categoria *</label>
          <p-dropdown id="categoria" formControlName="categoria" [options]="categories" optionLabel="label" optionValue="value"
                      placeholder="Selecione uma categoria" [showClear]="true"
                      [ngClass]="{'ng-invalid ng-dirty': submitted && f['categoria'].errors}"></p-dropdown>
          <small *ngIf="submitted && f['categoria'].errors?.['required']" class="p-error">Categoria é obrigatória</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="codigoBarras">Código de Barras *</label>
          <input id="codigoBarras" type="text" pInputText formControlName="codigoBarras" 
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['codigoBarras'].errors}">
          <small *ngIf="submitted && f['codigoBarras'].errors?.['required']" class="p-error">Código de Barras é obrigatório</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="codigoIdentificacao">Código de Identificação *</label>
          <input id="codigoIdentificacao" type="text" pInputText formControlName="codigoIdentificacao" 
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['codigoIdentificacao'].errors}">
          <small *ngIf="submitted && f['codigoIdentificacao'].errors?.['required']" class="p-error">Código de Identificação é obrigatório</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="local">Local</label>
          <input id="local" type="text" pInputText formControlName="local">
        </div>

        <div class="field col-12 md:col-6">
          <label for="responsavel">Responsável *</label>
          <input id="responsavel" type="text" pInputText formControlName="responsavel"
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['responsavel'].errors}">
          <small *ngIf="submitted && f['responsavel'].errors?.['required']" class="p-error">Responsável é obrigatório</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="voltagem">Voltagem *</label>
          <input id="voltagem" type="text" pInputText formControlName="voltagem"
                 [ngClass]="{'ng-invalid ng-dirty': submitted && f['voltagem'].errors}">
          <small *ngIf="submitted && f['voltagem'].errors?.['required']" class="p-error">Voltagem é obrigatória</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="valor">Valor *</label>
          <p-inputNumber id="valor" formControlName="valor" mode="decimal" [minFractionDigits]="2" [maxFractionDigits]="2"
                         [ngClass]="{'ng-invalid ng-dirty': submitted && f['valor'].errors}"></p-inputNumber>
          <small *ngIf="submitted && f['valor'].errors?.['required']" class="p-error">Valor é obrigatório</small>
          <small *ngIf="submitted && f['valor'].errors?.['min']" class="p-error">Valor deve ser positivo</small>
        </div>

        <div class="field col-12 md:col-6">
          <label for="stockQuantity">Quantidade em Estoque *</label>
          <p-inputNumber id="stockQuantity" formControlName="stockQuantity" [showButtons]="true" [min]="0"
                         [ngClass]="{'ng-invalid ng-dirty': submitted && f['stockQuantity'].errors}"></p-inputNumber>
          <small *ngIf="submitted && f['stockQuantity'].errors?.['required']" class="p-error">Quantidade em estoque é obrigatória</small>
          <small *ngIf="submitted && f['stockQuantity'].errors?.['min']" class="p-error">Quantidade em estoque deve ser zero ou positiva</small>
        </div>
      </div>

      <div class="flex justify-content-end mt-3">
        <button pButton type="button" label="Cancelar" class="p-button-secondary mr-2" (click)="cancel()"></button>
        <button pButton type="submit" label="Salvar" [disabled]="loading"></button>
      </div>
    </form>
  </div>
</div>

<p-toast></p-toast>
